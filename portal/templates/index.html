{% extends "base.html" %}
{% block head %}
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""
  />
  <script
    src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""
  ></script>
{% endblock %}
{% block body %}
<div class="container">
  <div id="map" style="width: 80%; height: 800px; margin-left: auto; margin-right: auto;"></div>
</div>
{% endblock %}
{% block script %}
  <script>
    // TODO this is kinda a hack :)
    var point_data = {{ geojson | safe }};
    var map = L.map("map").setView([51.42730, 6.89718], 15);

    function addPopup (feature, layer) {
      layer.bindPopup('<h1>hello</h1>')
    }

    L.tileLayer(
      "https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw",
      {
        maxZoom: 18,
        attribution:
          'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
          'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        id: "mapbox/streets-v11",
        tileSize: 512,
        zoomOffset: -1,
      }
    ).addTo(map);
    var points_layer = L.geoJSON(point_data).addTo(map);
    points_layer.eachLayer(function (layer) {
      layer.bindPopup("<script>" + "alert('hello!')" + "<\/script>");
    });
    // points_layer.addData(point_data);
  </script>
{% endblock %}
